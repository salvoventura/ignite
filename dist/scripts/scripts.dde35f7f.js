"use strict";var app=angular.module("PoapServer",["ngAnimate","ngAria","ngCookies","ngMessages","ngResource","ngRoute","ngSanitize","ngTouch","ui.bootstrap","ui.bootstrap.tpls","ngTable","angular-bootstrap-select","angular-svg-round-progress","file-model","filereader","angular-storage","angular-loading-bar","gettext","chart.js","ngToast","topologyModule"]);app.config(["$routeProvider",function(a){a.when("/",{templateUrl:"pages/common/views/login.html",controller:"LoginCtrl"}).when("/register",{templateUrl:"pages/common/views/register.html",controller:"RegisterCtrl"}).when("/configlets",{templateUrl:"pages/views/configlets.html",controller:"ConfigletsCtrl",activemenu:"resources",activetab:"configlets"}).when("/pools",{templateUrl:"pages/views/pools.html",controller:"PoolCtrl",activemenu:"resources",activetab:"pools"}).when("/configuration",{templateUrl:"pages/views/configuration.html",controller:"ConfigurationCtrl",activemenu:"resources",activetab:"configuration"}).when("/constructs/:mode",{templateUrl:"pages/views/constructs.html",controller:"ConstructCtrl",activemenu:"resources",activetab:"configuration"}).when("/constructs/:mode/:id",{templateUrl:"pages/views/constructs.html",controller:"ConstructCtrl",activemenu:"resources",activetab:"configuration"}).when("/topology",{templateUrl:"pages/views/topology.html",controller:"TopologyCtrl",activemenu:"resources",activetab:"topology"}).when("/topology/:mode/:topologyId",{templateUrl:"pages/views/addTopology.html",controller:"AddTopologyCtrl",activemenu:"resources",activetab:"topology"}).when("/discoveryRule",{templateUrl:"pages/views/discoveryRule.html",controller:"DiscoveryRuleCtrl",activemenu:"resources",activetab:"discoveryRule"}).when("/fabricInstance",{templateUrl:"pages/views/fabricInstance.html",controller:"FabricInstanceCtrl",activemenu:"fabric",activetab:"fabric"}).when("/fabricInstance/:mode/:fabricInstanceId",{templateUrl:"pages/views/addFabricInstance.html",controller:"AddFabricInstanceCtrl",activemenu:"fabric",activetab:"fabric"}).when("/deployedFabrics",{templateUrl:"pages/views/deployedFabricList.html",controller:"DeployedFabricCtrl",activemenu:"deployed",activetab:"deployedFabric"}).when("/deployedFabrics/:fabricID/:replicaNumber",{templateUrl:"pages/views/replicaDetails.html",controller:"FabricReplicaCtrl",activemenu:"deployed",activetab:"deployedFabric"}).when("/deployedSwitches",{templateUrl:"pages/views/deployedSwitches.html",controller:"DeployedSwitchesCtrl",activemenu:"deployed",activetab:"deployedSwitches"}).otherwise({redirectTo:"/"})}]),app.config(["ngToastProvider",function(a){a.configure({verticalPosition:"top",horizontalPosition:"center",maxNumber:10})}]),function(){angular.module("PoapServer").service("appServices",["$http","$q","$timeout","$log","$rootScope","$location","appSettings","lclStorage",function(a,b,c,d,e,f,g,h){var i=this;return i.errors=[],i.loginError="",i.generateSeq=function(a,b,c){return(a-1)*b+c+1},i.clearErrors=function(){i.errors=[],e.errorFlag=!1},i.setInternalAppUI=function(a){a.$parent.bodyClass="",a.$parent.isLogin=!1},i.tablePagination=function(a,b,c,d,e){var f=c.filter()?b("filter")(d,e):d,g=c.sorting()?b("orderBy")(f,c.orderBy()):f,h=g.slice((c.page()-1)*c.count(),c.page()*c.count());if(c.total(f.length),h.length>0)a.resolve(h);else{var i=c.page();i>1?c.page(i-1):a.resolve(h)}},i.getUrlParameter=function(a){var b=f.url();if(-1!=b.indexOf("?")){var c=b.split("?");i.urlParameters=c[1];for(var d=c[1].split("&"),e=0;e<d.length;e++){var g=d[e].split("=");if(g[0]==a)return g[1]}}},i.generateUniqueName=function(a,b){var c=b,d=b.split("_");if(!isNaN(d[d.length-1])){for(var e="",f=0;f<d.length-1;f++)e=e+"_"+d[f];c=e.substring(1,e.length)}if("undefined"!=typeof a){var g=0,h=[];return angular.forEach(a,function(a,b){if(a.name.indexOf(c)>-1){var d=a.name.split("_");d.length>1&&(d=d[d.length-1],isNaN(d)||h.push(Number(d))),g++}}),h.sort(function(a,b){return b-a}),0==h.length&&(h[0]=0),c+"_"+(h[0]+1)}},i.getStaticFile=function(e){var f=b.defer(),h=g["static"].baseURL+e.url,i={url:h};return c(function(){a(i).success(function(a,b,c,d){f.resolve(a)}).error(function(a,b,c,e){return 400==b?a:(d.debug("Error: Could not fetch data from:\n----------------------------------\n"+i.url),f.resolve(a),void f.reject(a))})},0),f.promise},i.doAPIRequest=function(f,j,k){var l=b.defer(),m=f.method,n=g.appAPI.baseURL+f.url,o={method:m,url:n};if("undefined"!=typeof j&&null!=j&&(o.data=j),"true"==f.auth){var p={"Content-Type":"application/json",Authorization:h.get("userDetails").auth_token};o.headers=p}if(null!=k&&"undefined"!=typeof k&&(1==k.appendToURL&&(k.noTrailingSlash?o.url=n+k.value:o.url=n+k.value+"/"),1==k.fileUpload)){"undefined"!=typeof o.headers?o.headers["Content-Type"]=void 0:o.headers={"Content-Type":void 0},o.headers.transformRequest=angular.identity;var q=new FormData;q.append("file",j),o.data=q}return console.log("httpParams"),console.log(o),c(function(){a(o).success(function(a,b,c,d){if(i.loginError="","error"==a.status){var f={msg:a.errorMessage};i.errors.push(f),e.errorFlag=!0}l.resolve(a)}).error(function(a,b,c,f){if(400==b){var g=null;return"undefined"!=typeof a.errorMessage?(g={msg:a.errorMessage},i.errors.push(g)):"undefined"!=typeof a.non_field_errors?i.loginError=a.non_field_errors[0]:(g={msg:a},i.errors.push(g)),e.errorFlag=!0,a}d.debug("Error: Could not fetch data from:\n----------------------------------\n"+o.url),l.reject(a)})},0),l.promise},i.getUtilizationColor=function(a){var b="";return angular.forEach(g.threshold,function(c,d){return a>=c.range[0]&&a<=c.range[1]?(b=c.color,!1):void 0}),b},i}]).factory("lclStorage",["store",function(a){return a.getNamespacedStore("ccpStore")}])}(),angular.module("PoapServer").controller("MainCtrl",["$scope","$location","$http","$routeParams","$filter","$rootScope","$modal","$log","appSettings","appServices","gettextCatalog","lclStorage",function(a,b,c,d,e,f,g,h,i,j,k,l){a.appSettings=i,a.appServices=j,a.deleteError=function(a){j.errors.splice(a,1)},a.logout=function(){l.remove("userDetails")},a.checklogin=function(){var a=l.get("userDetails"),c=b.path();null==a&&-1==c.indexOf("register")&&b.path("#")},a.init=function(){a.checklogin()},a.openErrorModal=function(){a.modalInstance=g.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/errorModal.html",controller:"errorModalCtrl",size:"md",backdrop:"static"}),a.modalInstance.result.then(function(){j.clearErrors()},function(){j.clearErrors(),h.info("Modal dismissed at: "+new Date)})},a.$watch(function(){return f.errorFlag},function(){1==f.errorFlag&&a.openErrorModal()}),a.init()}]),angular.module("PoapServer"),app.controller("HeaderCtrl",["$scope","$location","lclStorage","appServices","appSettings","$route",function(a,b,c,d,e,f){a.$route=f,a.userID=c.get("userID"),a.userDetails=c.get("userDetails")}]),angular.module("PoapServer").controller("LoginCtrl",["$scope","$location","appSettings","appServices","$modal","$log","lclStorage",function(a,b,c,d,e,f,g){a.$parent.bodyClass="loginBody",a.$parent.isLogin=!0,a.submit={username:"",password:""},a.login=function(){d.doAPIRequest(c.appAPI.users.login,a.submit,null).then(function(c){if("undefined"==typeof c.non_field_errors){var d={username:a.submit.username,auth_token:c.auth_token};g.set("userDetails",d),b.path("configlets")}})}}]),angular.module("PoapServer").controller("RegisterCtrl",["$scope","$location","appSettings","appServices","$modal","$log","lclStorage",function(a,b,c,d,e,f,g){a.$parent.bodyClass="loginBody",a.$parent.isLogin=!0,a.submit={username:"",password:"",email:"",first_name:"",last_name:""},a.confrimPassword="",a.passwordMatch=!0,a.register=function(){a.confrimPassword==a.submit.password&&d.doAPIRequest(c.appAPI.users.register,a.submit,null).then(function(c){c.username==a.submit.username&&b.path("#")})},a.matchPassword=function(){a.confrimPassword==a.submit.password?a.passwordMatch=!0:a.passwordMatch=!1}}]),angular.module("PoapServer").controller("PoolCtrl",["$scope","$location","$filter","ngTableParams","appSettings","appServices","gettextCatalog","lclStorage","$modal","$log","$timeout","roundProgressService",function(a,b,c,d,e,f,g,h,i,j,k,l){f.setInternalAppUI(a);a.$parent;a.totalItems=64,a.currentPage=4,a.setPage=function(b){a.currentPage=b},a.pageChanged=function(){j.log("Page changed to: "+a.currentPage)},a.maxSize=5,a.bigTotalItems=175,a.bigCurrentPage=1,a.animationsEnabled=!0,a.pools=[],a.open=function(b){var c=i.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/poolsModal.html",controller:"PoolsModalCtrl",size:b});c.result.then(function(b){a.selected=b},function(){j.info("Modal dismissed at: "+new Date)})},a.tableParams=new d({page:1,count:e.tableSettings.count,sorting:{name:"asc"},filter:{name:a.searchKeyword}},{counts:[],getData:function(b,d){f.tablePagination(b,c,d,a.pools,a.searchKeyword)}}),a.viewPool=function(b){var c=i.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/viewPoolModal.html",controller:"ViewPoolCtrl",size:b});c.result.then(function(b){a.selected=b},function(){j.info("Modal dismissed at: "+new Date)})},a.getPoolList=function(b){f.doAPIRequest(e.appAPI.pools.list,null,null).then(function(b){a.pools=b,a.totalPools=a.pools.length,a.tableParams.reload()})},a.checkAll=function(){a.selectedAll?(a.selectedAll=!0,a.selection=a.pools.map(function(a){return a.id})):(a.selectedAll=!1,a.selection.length=0),angular.forEach(a.pools,function(b){b.Selected=a.selectedAll})},a.selectPool=function(){for(var b=0;b<a.pools.length;b++)if(!a.pools[b].isChecked)return void(a.selectedAll=!1);a.selectedAll=!0},a.totalPools=0,a.currentPage=1,a.numPerPage=10,a.paginate=function(b){var c,d,e;return c=(a.currentPage-1)*a.numPerPage,d=c+a.numPerPage,d>=a.totalPools&&(d=a.totalPools),a.begin=c+1,a.end=d,e=a.pools.indexOf(b),e>=c&&d>e},a.selection=[],a.toggleSelection=function(b){var c=a.selection.indexOf(b);c>-1?a.selection.splice(c,1):a.selection.push(b)},a.deleteSelectedPool=function(){if(a.selection.length>0){var b=[];angular.forEach(a.pools,function(c){c.Selected?f.doAPIRequest(e.appAPI.pools["delete"],null,null).then(function(a){}):b.push(c),a.pools=b})}},a.addPool=function(){a.action="add",a.selectedId=null,a.openPoolModal()},a.viewPool=function(b){a.action="view",a.selectedId=b,a.openPoolModal()},a.editPool=function(b){a.action="edit",a.selectedId=b,a.openPoolModal()},a.deletePool=function(b,c){a.selectedId=b;var d=i.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/deleteModal.html",controller:"PoolsDeleteModalCtrl",size:"md",resolve:{dataToModal:function(){return{id:a.selectedId,index:c,callerScope:a}}}});d.result.then(function(b){a.submitData(b)},function(){j.info("Modal dismissed at: "+new Date)}),a.toggleSelection(a.selectedId),a.init()},a.animationsEnabled=!0,a.openPoolModal=function(){a.modalInstance=i.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/poolsModal.html",controller:"PoolsModalCtrl",size:"lg",backdrop:"static",resolve:{dataToModal:function(){return{action:a.action,id:a.selectedId,callerScope:a}}}}),a.modalInstance.result.then(function(b){a.submitData(b)},function(){j.info("Modal dismissed at: "+new Date)})},a.submitData=function(b){if("add"==b.action){var c=b.submitData,d={};f.doAPIRequest(e.appAPI.pools.add,c,null).then(function(b){a.init()})}else if("edit"==b.action){var c=b.submitData,d={appendToURL:!0,value:a.selectedId};f.doAPIRequest(e.appAPI.pools.edit,c,d).then(function(b){console.log(b),a.init()})}else if("delete"==b.action){var d={appendToURL:!0,value:a.selectedId};f.doAPIRequest(e.appAPI.pools["delete"],null,d).then(function(b){a.init("delete"),a.modalInstance.dismiss()})}},a.init=function(){a.getPoolList()},a.$watch("searchKeyword",function(){a.tableParams.reload(),a.tableParams.page(1)}),a.checkboxes={checked:!1,items:{}},a.$watch("checkboxes.checked",function(b){angular.forEach(a.pools,function(c){angular.isDefined(c.id)&&(a.checkboxes.items[c.id]=b)})}),a.$watch("checkboxes.items",function(b){if(a.pools){var c=0,d=0,e=a.pools.length;angular.forEach(a.pools,function(b){c+=a.checkboxes.items[b.id]||0,d+=!a.checkboxes.items[b.id]||0}),(0==d||0==c)&&(a.checkboxes.checked=c==e),angular.element(document.getElementById("select_all")).prop("indeterminate",0!=c&&0!=d)}},!0),a.init(),a.toggleAnimation=function(){a.animationsEnabled=!a.animationsEnabled}}]),angular.module("PoapServer").controller("PoolsModalCtrl",["$scope","$modalInstance","$filter","ngTableParams","appSettings","appServices","dataToModal","$modal","$log",function(a,b,c,d,e,f,g,h,i){a.appSettings=e,a.action=g.action,a.totalItems=64,a.currentPage=4,a.maxSize=5,a.bigTotalItems=175,a.bigCurrentPage=1,a.usedData=[],a.tableParams=new d({page:1,count:e.tableSettings.count,sorting:{name:"asc"},filter:{name:a.searchKeyword}},{counts:[],getData:function(b,d){f.tablePagination(b,c,d,a.usedData,a.searchKeyword)}}),a.$watch("searchKeyword",function(){a.tableParams.reload(),a.tableParams.page(1)}),a.setPage=function(b){a.currentPage=b},a.pageChanged=function(){i.log("Page changed to: "+a.currentPage)},a.submitData={name:"",type:e.defaultData.pools.type,scope:e.defaultData.pools.scope,range:[{start:"",end:""}]},a.ok=function(){b.close({submitData:a.submitData,action:a.action})},a.cancel=function(){b.dismiss("cancel")},a.getData=function(){if("view"==a.action||"edit"==a.action){var b={appendToURL:!0,value:g.id};f.doAPIRequest(e.appAPI.pools.getById,null,b).then(function(b){a.submitData=b,a.usedData=b.used_data,a.totalUsedData=a.usedData.length,a.tableParams.reload()})}},a.init=function(){a.getData()},a.changeAction=function(b){a.action=b},a.addRange=function(){a.submitData.range.push({start:"",end:""})},a.removeRange=function(b){a.submitData.range.splice(b,1)},a.deletePool=function(){g.callerScope.deletePool(g.id,g.index)},a.checkAll=function(b){a.isChecked=$(b.toElement).is(":checked")},a.init()}]),angular.module("PoapServer").controller("ViewPoolCtrl",["$scope","$modalInstance",function(a,b){a.ok=function(){b.close()},a.cancel=function(){b.dismiss("cancel")}}]),angular.module("PoapServer").controller("PoolsDeleteModalCtrl",["$scope","$modalInstance","appSettings","appServices","dataToModal",function(a,b,c,d,e){a.ok=function(){b.close({action:"delete",id:e.id,index:e.index})},a.cancel=function(){b.dismiss("cancel")}}]),angular.module("PoapServer").controller("ConfigurationCtrl",["$scope","$location","$filter","ngTableParams","appSettings","appServices","gettextCatalog","lclStorage","$modal","$log","$timeout","roundProgressService",function(a,b,c,d,e,f,g,h,i,j,k,l){f.setInternalAppUI(a);a.$parent;a.configurations=[],a.tableParams=new d({page:1,count:e.tableSettings.count,sorting:{name:"asc"}},{counts:[],getData:function(b,d){f.tablePagination(b,c,d,a.configurations,a.searchKeyword)}}),a.getConfigurationList=function(){f.doAPIRequest(e.appAPI.configuration.list,null,null).then(function(b){a.configurations=b,a.tableParams.reload()})},a.deleteConfiguration=function(b,c){a.selectedId=b;var d=i.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/deleteModal.html",controller:"ConfigDeleteModalCtrl",size:"md",backdrop:"static",resolve:{dataToModal:function(){return{id:a.selectedId,index:c}}}});d.result.then(function(b){a.submitData(b)},function(){j.info("Modal dismissed at: "+new Date)})},a.submitData=function(b){if("delete"==b.action){var c={appendToURL:!0,value:a.selectedId,noTrailingSlash:!0};f.doAPIRequest(e.appAPI.configuration["delete"],null,c).then(function(b){a.init()})}},a.init=function(){a.getConfigurationList()},a.init(),a.$watch("searchKeyword",function(){a.tableParams.reload(),a.tableParams.page(1)})}]),angular.module("PoapServer").controller("ConfigDeleteModalCtrl",["$scope","$modalInstance","FileReader","appSettings","appServices","dataToModal",function(a,b,c,d,e,f){a.ok=function(){b.close({action:"delete",id:f.id,index:f.index})},a.cancel=function(){b.dismiss("cancel")}}]),angular.module("PoapServer").controller("ConstructCtrl",["$scope","$location","$routeParams","appSettings","appServices","gettextCatalog","lclStorage","$modal","$log","$timeout","roundProgressService",function(a,b,c,d,e,f,g,h,i,j,k){e.setInternalAppUI(a);a.$parent;a.checkbox=[],a.animationsEnabled=!0,a.submitData={name:"",submit:!1,construct_list:[]},a.getConfigletName=function(b){var c="";return angular.forEach(a.configlets,function(a,d){return a.id==b?(c=a.name,!1):void 0}),c},a.getParamValue=function(b,c){if("Pool"!=b)return c;var d="";return angular.forEach(a.pools,function(a,b){return a.id==c?(d=a.name,!1):void 0}),d};var l=function(b){if("start"==b)return 0;if("end"==b)return a.submitData.construct_list.length;if("before"==b||"after"==b){var c=$("#constructsList").find(".chk"),d=0,e=0;if($.each(c,function(a,b){1==$(this).is(":checked")&&(d++,e=a)}),0==d)return alert("Select a row for this action."),!1;if(d>1)return alert("More than one row cannot be selected for this action."),!1;if("before"==b)return e;if("after"==b)return e+1}};a.constructDialog=function(b,c,d){var e=l(c);e!==!1&&(a.constructModalInstance=h.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/constructModal.html",controller:"constructModalCtrl",size:"lg",backdrop:"static",resolve:{dataToModal:function(){var c={pools:a.pools,configlets:a.configlets,action:b,position:e,index:d,mode:a.mode,callerScope:a};return("view"==b||"edit"==b)&&(c.editData=a.submitData.construct_list[d]),c}}}),a.constructModalInstance.result.then(function(b){a.addEditConstruct(b)},function(){i.info("Modal dismissed at: "+new Date)}))},a.addEditConstruct=function(b){"add"==b.action&&a.submitData.construct_list.splice(b.position,0,b.submitData),"edit"==b.action&&a.submitData.construct_list.splice(b.index,1,b.submitData)},a.submit=function(){a.submitData.submit=!0,a.doSubmit()},a.save=function(){a.doSubmit()},a.doSubmit=function(){var f=c.mode;if("add"==f||"clone"==f)e.doAPIRequest(d.appAPI.configuration.add,a.submitData,null).then(function(a){b.path("/configuration")});else if("edit"==f){var g=c.id,h={appendToURL:!0,value:g,noTrailingSlash:!0};e.doAPIRequest(d.appAPI.configuration.edit,a.submitData,h).then(function(a){b.path("/configuration")})}},a.getPoolList=function(){e.doAPIRequest(d.appAPI.pools.list,null,null).then(function(b){a.pools=b})},a.getConfigletList=function(){e.doAPIRequest(d.appAPI.configlets.list,null,null).then(function(b){a.configlets=b})},a.toggleAnimation=function(){a.animationsEnabled=!a.animationsEnabled},a.getConfiguration=function(){var b=c.id,f={appendToURL:!0,value:b,noTrailingSlash:!0};e.doAPIRequest(d.appAPI.configuration.view,null,f).then(function(b){a.submitData=b,"clone"==c.mode&&(a.submitData.name="")})},a.init=function(){a.getConfigletList(),a.getPoolList(),a.mode=c.mode,a.configId=c.id,("edit"==c.mode||"view"==c.mode||"clone"==c.mode)&&a.getConfiguration()},a.goBack=function(a){b.path(a)},a.deleteConfiguration=function(b,c){a.selectedId=a.configId;var d=h.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/deleteModal.html",controller:"ConfigDeleteModalCtrl",size:"md",backdrop:"static",resolve:{dataToModal:function(){return{id:a.selectedId,index:c}}}});d.result.then(function(b){a.doDelete(b)},function(){i.info("Modal dismissed at: "+new Date)})},a.doDelete=function(){var f=c.id,g={appendToURL:!0,value:f,noTrailingSlash:!0};e.doAPIRequest(d.appAPI.configuration["delete"],a.submitData,g).then(function(a){b.path("/configuration")})},a.deleteConstruct=function(b){var c=h.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/deleteModal.html",controller:"ConstructDeleteModalCtrl",size:"md",backdrop:"static",resolve:{dataToModal:function(){return{index:b}}}});c.result.then(function(b){"delete"==b.action&&a.doDeleteConstruct(b)},function(){i.info("Modal dismissed at: "+new Date)})},a.doDeleteConstruct=function(b){a.submitData.construct_list.splice(b.index,1),a.constructModalInstance.dismiss()},a.configletDialog=function(b){a.modalInstance=h.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/configletsModal.html",controller:"ConfigletsModalCtrl",size:"lg",backdrop:"static",resolve:{dataToModal:function(){return{action:"viewothers",id:b}}}})},a.init()}]),angular.module("PoapServer").controller("ConstructDeleteModalCtrl",["$scope","$modalInstance","appSettings","appServices","dataToModal",function(a,b,c,d,e){a.ok=function(){b.close({action:"delete",index:e.index})},a.cancel=function(){b.dismiss("cancel")}}]),angular.module("PoapServer").controller("constructModalCtrl",["$scope","$modalInstance","$modal","appServices","appSettings","dataToModal",function(a,b,c,d,e,f){a.appSettings=e,a.params_list=[],a.action=f.action,a.submitData={configlet_id:"",param_list:[]},a.configlets=[],a.resetValues=function(){a.submitData.configlet_id="",a.params_list=[]},a.filterConfiglets=function(){a.resetValues(),a.configlets=[],"append_configlet"==a.submitData.construct_type?a.configlets=a.filterConstruct("template"):"append_script"==a.submitData.construct_type&&(a.configlets=a.filterConstruct("script"))},a.filterConstruct=function(b){var c=[];return angular.forEach(a.configletsCache,function(a,d){a.config_type==b&&c.push(a)}),c},a.filterParams=function(){a.params_list=[],angular.forEach(a.configletsCache,function(b,c){b.id==a.submitData.configlet_id&&angular.forEach(b.parameters,function(b,c){var d={param_name:b,param_type:"",param_value:""};a.params_list.push(d)})})},a.ok=function(){console.log(a.submitData),b.close({submitData:a.submitData,action:a.action,position:f.position,index:f.index})},a.cancel=function(){b.dismiss("cancel")},a.setValues=function(){a.submitData.construct_type=f.editData.construct_type,a.filterConfiglets(),setTimeout(function(){a.submitData.configlet_id=f.editData.configlet_id,angular.copy(f.editData.param_list,a.params_list),angular.copy(f.editData.param_list,a.submitData.param_list),a.$digest()},500)},a.init=function(){a.pools=f.pools,a.configletsCache=f.configlets,a.mode=f.mode,a.constructIndex=f.index,("view"==f.action||"edit"==f.action)&&a.setValues()},a.deleteConstruct=function(a){f.callerScope.deleteConstruct(a)},a.init()}]),angular.module("PoapServer").controller("ConfigletsCtrl",["$scope","$location","$filter","ngTableParams","appSettings","appServices","gettextCatalog","lclStorage","$modal","$log","$timeout","roundProgressService",function(a,b,c,d,e,f,g,h,i,j,k,l){f.setInternalAppUI(a);a.$parent;a.configlets=[],a.tableParams=new d({page:1,count:e.tableSettings.count,sorting:{name:"asc"}},{counts:[],getData:function(b,d){f.tablePagination(b,c,d,a.configlets,a.searchKeyword)}}),a.selectedId=null,a.init=function(b){a.getConfigletList()},a.getConfigletList=function(){f.doAPIRequest(e.appAPI.configlets.list,null,null).then(function(b){a.configlets=b,a.tableParams.reload()})},a.addConfiglet=function(){a.action="add",a.selectedId=null,a.openConfigletModal()},a.viewConfiglet=function(b,c){a.action="view",a.selectedId=b,a.openConfigletModal(c)},a.editConfiglet=function(b,c){a.action="edit",a.selectedId=b,a.openConfigletModal(c)},a.deleteConfiglet=function(b,c){a.selectedId=b;var d=i.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/deleteModal.html",controller:"ConfigletsDeleteModalCtrl",size:"md",backdrop:"static",resolve:{dataToModal:function(){return{id:a.selectedId,index:c}}}});d.result.then(function(b){a.submitData(b)},function(){j.info("Modal dismissed at: "+new Date)})},a.animationsEnabled=!0,a.openConfigletModal=function(b){a.modalInstance=i.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/configletsModal.html",controller:"ConfigletsModalCtrl",size:"lg",backdrop:"static",resolve:{dataToModal:function(){return{action:a.action,id:a.selectedId,callerScope:a,index:b}}}}),a.modalInstance.result.then(function(b){a.submitData(b)},function(){j.info("Modal dismissed at: "+new Date)})},a.uploadConfigletFile=function(a,b,c){var d={fileUpload:!0,appendToURL:!0,value:a.id},g=b;f.doAPIRequest(e.appAPI.configlets.upload,g,d).then(function(a){c.call(this,a)})},a.submitData=function(b){if("add"==b.action){var c=b.submitData,d={};f.doAPIRequest(e.appAPI.configlets.add,c,null).then(function(c){"undefined"!=typeof b.uploadFile?a.uploadConfigletFile(c,b.uploadFile,function(b){console.log(b),a.init()}):a.init()})}else if("edit"==b.action){if("undefined"!=typeof b.uploadFile){var g={id:a.selectedId};a.uploadConfigletFile(g,b.uploadFile,function(a){console.log(a)})}}else if("delete"==b.action){var d={appendToURL:!0,value:a.selectedId};f.doAPIRequest(e.appAPI.configlets["delete"],null,d).then(function(b){a.init("delete"),"undefined"!=typeof a.modalInstance&&a.modalInstance.dismiss()})}},a.toggleAnimation=function(){a.animationsEnabled=!a.animationsEnabled},a.$watch("searchKeyword",function(){a.tableParams.reload(),a.tableParams.page(1)}),a.init()}]),angular.module("PoapServer").controller("ConfigletsModalCtrl",["$scope","$modalInstance","FileReader","appSettings","appServices","dataToModal",function(a,b,c,d,e,f){a.appSettings=d,a.action=f.action,a.readFile=function(b){a.content=b},a.submitData={name:"",group:"",config_type:d.defaultData.configlets.config_type},a.ok=function(){b.close({submitData:a.submitData,uploadFile:a.uploadFile,action:a.action})},a.cancel=function(){b.dismiss("cancel")},a.getData=function(){if("view"==a.action||"edit"==a.action||"viewothers"==a.action){var b={appendToURL:!0,value:f.id};e.doAPIRequest(d.appAPI.configlets.getById,null,b).then(function(b){a.submitData=b,a.view={fileContent:b.fileContent}})}},a.init=function(){a.getData()},a.changeAction=function(b){a.action=b},a.deleteConfiglet=function(){f.callerScope.deleteConfiglet(f.id,f.index)},a.init()}]),angular.module("PoapServer").controller("ConfigletsDeleteModalCtrl",["$scope","$modalInstance","FileReader","appSettings","appServices","dataToModal",function(a,b,c,d,e,f){a.ok=function(){b.close({action:"delete",id:f.id,index:f.index})},a.cancel=function(){b.dismiss("cancel")}}]),angular.module("PoapServer").controller("TopologyCtrl",["$scope","$rootScope","$location","$filter","ngTableParams","appSettings","appServices","gettextCatalog","lclStorage","$modal","$log","$timeout","roundProgressService","ngToast",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){g.setInternalAppUI(a);a.$parent;a.totalItems=64,a.currentPage=4,a.maxSize=5,a.bigTotalItems=175,a.bigCurrentPage=1,a.animationsEnabled=!0,a.topologies=[],a.animationsEnabled=!0,a.tableParams=new e({page:1,count:f.tableSettings.count,sorting:{name:"asc"},filter:{name:a.searchKeyword}},{counts:[],getData:function(b,c){g.tablePagination(b,d,c,a.topologies,a.searchKeyword)}}),a.$watch("searchKeyword",function(){a.tableParams.reload(),a.tableParams.page(1)}),a.setPage=function(b){a.currentPage=b},a.pageChanged=function(){k.log("Page changed to: "+a.currentPage)},a.checkAll=function(b){a.isChecked=$(b.toElement).is(":checked")},a.toggleAnimation=function(){a.animationsEnabled=!a.animationsEnabled},a.getTopologyList=function(){g.doAPIRequest(f.appAPI.topology.list,null,null).then(function(b){a.topologies=b,a.totalTopologies=a.topologies.length,a.tableParams.reload()})},a.deleteTopology=function(b,c){a.selectedId=b;var d=j.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/deleteModal.html",controller:"TopologyDeleteModalCtrl",size:"md",resolve:{dataToModal:function(){return{id:a.selectedId,index:c,callerScope:a}}}});d.result.then(function(b){a.submitData(b)},function(){k.info("Modal dismissed at: "+new Date)}),a.init()},a.cloneTopology=function(b){a.action="clone",a.selectedId=b,a.openCloneModal()},a.openCloneModal=function(b){console.log("Inside Open Clone");var c=j.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/cloneModal.html",controller:"TopologyCloneModalCtrl",size:"sm",resolve:{dataToModal:function(){return{action:a.action,id:a.selectedId}}}});c.result.then(function(b){a.submitData(b)},function(){k.info("Modal dismissed at: "+new Date)})},a.submitData=function(b){if("delete"==b.action){var c={appendToURL:!0,value:a.selectedId,noTrailingSlash:!0};g.doAPIRequest(f.appAPI.topology["delete"],null,c).then(function(b){n.create({className:"success",content:"Topology Deleted Successfully."}),a.init("delete")})}else if("clone"==b.action){var d=(b.submitData,{appendToURL:!0,value:a.selectedId,noTrailingSlash:!0});g.doAPIRequest(f.appAPI.topology.getById,null,d).then(function(c){k.debug("Data Fetched for Topology Id : "+a.selectedId),k.debug(c);var d=angular.copy(c);k.debug("DATA::"),k.debug(c),d.id="",d.name=b.submitData.NewCloneName,k.debug("New To[po]"),k.debug(d),d.submit="false",g.doAPIRequest(f.appAPI.topology.add,d,null).then(function(b){n.create({className:"success",content:"Topology Cloned Successfully."}),a.init("cloned")})})}},a.init=function(){a.getTopologyList()},a.init()}]),angular.module("PoapServer").controller("TopologyCloneModalCtrl",["$scope","$modalInstance","appSettings","appServices","dataToModal",function(a,b,c,d,e){a.action=e.action,a.id=e.id,a.submitData={NewCloneName:""},a.ok=function(){b.close({submitData:a.submitData,action:a.action,id:a.id})},a.cancel=function(){b.dismiss("cancel")},a.init=function(){},a.init()}]),angular.module("PoapServer").controller("TopologyDeleteModalCtrl",["$scope","$modalInstance","appSettings","appServices","dataToModal",function(a,b,c,d,e){a.ok=function(){b.close({action:"delete",id:e.id,index:e.index})},a.cancel=function(){b.dismiss("cancel")}}]),angular.module("PoapServer").controller("AddTopologyCtrl",["$scope","$rootScope","$routeParams","$http","$location","appSettings","appServices","gettextCatalog","lclStorage","$modal","$log","$timeout","roundProgressService","ngToast",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){a.$parent;a.goBack=function(a){e.path(a)},a.dynamicPopover={templateUrl:"topologyPopoverDir.html"},a.topologyPopover={templateUrl:"topologyPopFormDir.html"},a.topologyDisplayPopover={templateUrl:"topologyDisplayPopover.html"},a.select=function(b){a.selected=b},a.isActive=function(b){return a.selected===b},a.gettTopologyItem=function(){g.doAPIRequest(f.appAPI.topology.item,null,null).then(function(b){a.topology=b})},a.maxCore=4,a.maxSpine=8,a.maxLeaf=192,a.maxHost=1e3,a.topologyStructure={config_json:[],name:"",submit:"false",defaults:{spine_switch:"NX9504",leaf_switch:"NX9332PQ",spine_leaf_link:"Linkset-1Link",spine_leaf_link_index:"0"},topology_json:{core_list:[],spine_list:[],leaf_list:[],host_list:[],link_list:[]}},a.coreStructure={id:"core",name:"Core",type:"BGPCore"},a.spineStructure={id:"spine",name:"Spine",type:"NX9504"},a.leafStructure={id:"leaf",name:"Leaf",type:"NX9332PQ"},a.hostStructure={id:"host",name:"Host",type:"Host1"},a.linkStructure={id_2:"",switch_2:"",port_list_2:[""],id_1:"",switch_1:"",port_list_1:[""],link_type:""},a.coreTypes=["BGPCore"],a.spineTypes=["NX9504","NX9508","NX9516"],a.leafTypes=["NX9332PQ","NX9372PX","NX9372TX","NX9396PX","NX9396TX","NX93120TX","NX93128TX"],a.hostTypes=["Host1","Host2"],a.coreToSpineLinkTypeDefault=0,a.spineToLeafLinkTypeDefault=parseInt(a.topologyStructure.defaults.spine_leaf_link_index),a.leafToLeafLinkTypeDefault=4,a.leafToHostLinkTypeDefault=0,a.linkTypes=[{link_group:"Linkset",link_type:"Linkset-1Link",link_ports:1,link_combo:[["core","spine"],["spine","leaf"],["leaf","host"]]},{link_group:"Linkset",link_type:"Linkset-2Link",link_ports:2,link_combo:[["core","spine"],["spine","leaf"],["leaf","host"]]},{link_group:"Linkset",link_type:"Linkset-3Link",link_ports:3,link_combo:[["core","spine"],["spine","leaf"],["leaf","host"]]},{link_group:"Linkset",link_type:"Linkset-4Link",link_ports:4,link_combo:[["core","spine"],["spine","leaf"],["leaf","host"]]},{link_group:"VPC",link_type:"VPC-1Link",link_ports:1,link_combo:[["leaf","leaf"]]},{link_group:"VPC",link_type:"VPC-2Link",link_ports:2,link_combo:[["leaf","leaf"]]},{link_group:"VPC",link_type:"VPC-3Link",link_ports:3,link_combo:[["leaf","leaf"]]},{link_group:"VPC",link_type:"VPC-4Link",link_ports:4,link_combo:[["leaf","leaf"]]},{link_group:"PortChannel",link_type:"PortChannel-1Link",link_ports:1,
link_combo:[["leaf","host"]]},{link_group:"PortChannel",link_type:"PortChannel-2Link",link_ports:2,link_combo:[["leaf","host"]]},{link_group:"PortChannel",link_type:"PortChannel-3Link",link_ports:3,link_combo:[["leaf","host"]]},{link_group:"PortChannel",link_type:"PortChannel-4Link",link_ports:4,link_combo:[["leaf","host"]]},{link_group:"KeepAliveLink",link_type:"KeepAliveLink",link_ports:1,link_combo:[["leaf","leaf"]]}],a.topologyData=angular.copy(a.topologyStructure),a.newTopology=function(){a.coreLeft=0,a.spineLeft=0,a.leafLeft=0,a.topology=angular.copy(a.topologyStructure),doReload(a.topology)},a.doReset=function(){confirm("Are you sure you want to reset to last loaded data?")&&(a.topology=angular.copy(a.topologyData),doReload(a.topology))},a.coreLeft=0,a.spineLeft=0,a.leafLeft=0,a.$watch(function(){angular.isUndefined(a.topology)||angular.isUndefined(a.topology.topology_json)||(a.coreLeft=a.topology.topology_json.core_list.length,a.spineLeft=a.topology.topology_json.spine_list.length,a.leafLeft=a.topology.topology_json.leaf_list.length)}),a.notDone=function(){alert("Not Implemented")},a.portMaker=function(a){var b={portChar:"Ethernet",rackStart:1,noOfRacks:1,noOfPorts:64};b.maxPorts=b.noOfRacks*b.noOfPorts;for(var c=$.extend(b,a),d=[],e=c.rackStart;e<c.noOfRacks+1;e++)for(var f=0;f<c.noOfPorts;f++){var g=c.portChar+e+"/"+(f+1);d.push(g)}return d},a.corePorts=a.portMaker(),a.spinePorts=a.portMaker(),a.leafPorts=a.portMaker({rackStart:2,noOfRacks:2,noOfPorts:12}),a.hostPorts=a.portMaker(),a.corePortAutoPopulate=function(b,c){console.log("coreIndex="+b);var d=a.topology.topology_json.core_list[b];if(!angular.isUndefined(d)&&!angular.isUndefined(d.ports)){if(0!=d.ports.length){var e=d.ports.shift();if(console.log(d),void 0==c)var c=[];return c.push(e),c}n.create({className:"danger",content:"Sorry, No more ports to assign for core "+a.topology.topology_json.core_list[b].name})}},a.spinePortAutoPopulate=function(b,c){console.log("spineIndex="+b);var d=a.topology.topology_json.spine_list[b];if(!angular.isUndefined(d)&&!angular.isUndefined(d.ports)){if(0!=d.ports.length){if(console.log(d),void 0==c)var c=[];for(var e=0;e<a.linkTypes[parseInt(a.topology.defaults.spine_leaf_link_index)].link_ports;e++){var f=d.ports.shift();c.push(f)}return c}n.create({className:"danger",content:"Sorry, No more ports to assign for spine "+a.topology.topology_json.spine_list[b].name})}},a.leafPortAutoPopulate=function(b,c){var d=a.topology.topology_json.leaf_list[b];if(!angular.isUndefined(d)&&!angular.isUndefined(d.ports)){if(0!=d.ports.length){if(void 0==c)var c=[];for(var e=0;e<a.linkTypes[parseInt(a.topology.defaults.spine_leaf_link_index)].link_ports;e++){var f=d.ports.shift();c.push(f)}return c}n.create({className:"danger",content:"Sorry, No more ports to assign for leaf "+a.topology.topology_json.leaf_list[b].name})}},a.hostPortAutoPopulate=function(b,c){var d=a.topology.topology_json.host_list[b];if(!angular.isUndefined(d)&&!angular.isUndefined(d.ports)){if(0!=d.ports.length){var e=d.ports.shift();if(void 0==c)var c=[];return c.push(e),c}n.create({className:"danger",content:"Sorry, No more ports to assign for host "+a.topology.topology_json.host_list[b].name})}},a.addCore=function(){var b=a.topology.topology_json.core_list.length;if(b>=a.maxCore)a.modalContent="You cannot have more than "+a.maxCore+" core in a topology.",$("#myModal").modal("toggle");else{var c=angular.copy(a.coreStructure);c.id=a.coreStructure.id+(b+1),c.name=a.coreStructure.name+"-"+(b+1),c.ports=angular.copy(a.corePorts),a.topology.topology_json.core_list.splice(b,0,c),k.debug("Add a core"),k.debug(a.topology.topology_json.core_list),a.connectCoreToSpine(b),doReload(a.topology)}},a.connectCoreToSpine=function(b){if(k.debug("Connect Core to Spine if Spine exists"),void 0!=a.topology.topology_json.spine_list&&a.topology.topology_json.spine_list.length>0)for(var c=0;c<a.topology.topology_json.spine_list.length;c++){var d=angular.copy(a.linkStructure);d.id_1=a.topology.topology_json.core_list[b].id,d.id_2=a.topology.topology_json.spine_list[c].id,d.switch_1=a.topology.topology_json.core_list[b].name,d.switch_2=a.topology.topology_json.spine_list[c].name,d.link_type=a.linkTypes[a.coreToSpineLinkTypeDefault].link_type,d.port_list_1=a.corePortAutoPopulate(b),d.port_list_2=a.spinePortAutoPopulate(c),a.topology.topology_json.link_list.push(d)}},a.addSpine=function(){var b=a.topology.topology_json.spine_list.length;if(b>=a.maxSpine)a.modalContent="You cannot have more than "+a.maxSpine+" spine in a topology.",$("#myModal").modal("toggle");else{var c=angular.copy(a.spineStructure);c.id=a.spineStructure.id+(b+1),c.name=a.spineStructure.name+"-"+(b+1),c.ports=angular.copy(a.spinePorts),a.topology.topology_json.spine_list.splice(b,0,c),a.connectSpineToLeaf(b),k.debug("Add a Spine"),k.debug(a.topology),doReload(a.topology)}},a.connectSpineToLeaf=function(b){if(void 0!=a.topology.topology_json.core_list&&a.topology.topology_json.core_list.length>0)for(var c=0;c<a.topology.topology_json.core_list.length;c++){var d=angular.copy(a.linkStructure);d.id_1=a.topology.topology_json.core_list[c].id,d.id_2=a.topology.topology_json.spine_list[b].id,d.switch_1=a.topology.topology_json.core_list[c].name,d.switch_2=a.topology.topology_json.spine_list[b].name,d.link_type=a.linkTypes[parseInt(a.topology.defaults.spine_leaf_link_index)].link_type,d.port_list_1=a.corePortAutoPopulate(c),d.port_list_2=a.spinePortAutoPopulate(b),a.topology.topology_json.link_list.push(d)}if(void 0!=a.topology.topology_json.leaf_list&&a.topology.topology_json.leaf_list.length>0)for(var c=0;c<a.topology.topology_json.leaf_list.length;c++){var d=angular.copy(a.linkStructure);d.id_1=a.topology.topology_json.spine_list[b].id,d.id_2=a.topology.topology_json.leaf_list[c].id,d.switch_1=a.topology.topology_json.spine_list[b].name,d.switch_2=a.topology.topology_json.leaf_list[c].name,d.link_type=a.linkTypes[parseInt(a.topology.defaults.spine_leaf_link_index)].link_type,d.port_list_1=a.spinePortAutoPopulate(b-1),d.port_list_2=a.leafPortAutoPopulate(c),a.topology.topology_json.link_list.push(d)}},a.addLeaf=function(){if(0==a.topology.topology_json.spine_list.length)return void n.create({className:"warning",content:"Please add a Spine before adding a Leaf."});var b=a.topology.topology_json.leaf_list.length;if(b>=a.maxLeaf)a.modalContent="You cannot have more than "+a.maxLeaf+" leaf in a topology.",$("#myModal").modal("toggle");else{var c=angular.copy(a.leafStructure);c.id=a.leafStructure.id+(b+1),c.name=a.leafStructure.name+"-"+(b+1),c.ports=angular.copy(a.leafPorts),a.topology.topology_json.leaf_list.splice(b,0,c),a.connectLeafToSpine(b),k.debug("Add a Leaf"),k.debug(a.topology),doReload(a.topology)}},a.connectLeafToSpine=function(b){if(void 0!=a.topology.topology_json.spine_list&&a.topology.topology_json.spine_list.length>0)for(var c=0;c<a.topology.topology_json.spine_list.length;c++){var d=angular.copy(a.linkStructure);d.id_1=a.topology.topology_json.spine_list[c].id,d.id_2=a.topology.topology_json.leaf_list[b].id,d.switch_1=a.topology.topology_json.spine_list[c].name,d.switch_2=a.topology.topology_json.leaf_list[b].name,d.link_type=a.linkTypes[parseInt(a.topology.defaults.spine_leaf_link_index)].link_type,d.port_list_1=a.spinePortAutoPopulate(c),d.port_list_2=a.leafPortAutoPopulate(b),a.topology.topology_json.link_list.push(d)}},a.connectLeafToLeaf=function(b){if(b>0){var c=angular.copy(a.leafToLeafLinkStructure);c.switch_1="leaf"+b,c.switch_2="leaf"+(b+1),c.link_type=a.linkTypes[a.leafToLeafLinkTypeDefault].link_type,c.port_list_1=a.leafPortAutoPopulate(b-1),c.port_list_2=a.leafPortAutoPopulate(b-1),k.debug("**************************"),k.debug(c),a.topology.topology_json.link_list.push(c)}},a.addHost=function(b,c){var d=a.topology.topology_json.host_list.length;if(d>=a.maxHost)a.modalContent="You cannot have more than "+a.maxHost+" hosts in a topology.",$("#myModal").modal("toggle");else{var e=angular.copy(a.hostStructure);e.id=a.hostStructure.id+(d+1),e.name=a.hostStructure.name+"-"+(d+1),e.ports=angular.copy(a.hostPorts),a.topology.topology_json.host_list.splice(d,0,e),a.connectHostToLeaf(d,b,c),k.debug("Add a Host"),k.debug(a.topology),doReload(a.topology)}},a.connectHostToLeaf=function(b,c,d){if(void 0!=a.topology.topology_json.host_list&&a.topology.topology_json.host_list.length>0){var e=angular.copy(a.linkStructure);e.id_1=a.topology.topology_json.leaf_list[d].id,e.id_2=a.topology.topology_json.host_list[b].id,e.switch_1=a.topology.topology_json.leaf_list[d].name,e.switch_2=a.topology.topology_json.host_list[b].name,e.link_type=a.linkTypes[a.leafToHostLinkTypeDefault].link_type,e.port_list_1=a.leafPortAutoPopulate(d),e.port_list_2=a.hostPortAutoPopulate(b),a.topology.topology_json.link_list.push(e)}},a.updatePortsByLinkType=function(b){k.debug("updatePortsByLinkType"),k.debug(b);for(var c=0;c<a.linkTypes.length;c++)if(a.linkTypes[c].link_type==b.link_type){k.debug(c+" $scope.linkTypes[j].link_type == link.link_type"+a.linkTypes[c].link_type+"=="+b.link_type+" # port="+a.linkTypes[c].link_ports),b.port_list_1=[],b.port_list_2=[];for(var d=0;d<a.linkTypes[c].link_ports;d++)k.debug("in here"),b.port_list_1.push("x"+d),b.port_list_2.push("x"+d);break}},a.saveReload=function(b,c,d){for(var e=0;e<a.topology.topology_json.link_list.length;e++)a.topology.topology_json.link_list[e].id_1==c&&(a.topology.topology_json.link_list[e].switch_1=b[d].name),a.topology.topology_json.link_list[e].id_2==c&&(a.topology.topology_json.link_list[e].switch_2=b[d].name);saveReloadTopology(a.topology)},a.toDeleteItem=0,a.toDeleteList="",a.deleteItem=function(b,c,d){$("#popEdit").hide(),$("#popEdit_Item_"+itemID).hide(),$("#popEditLink_Item_"+itemLinkID).hide(),$("#modalDeleteContent").html("Are you sure you want to delete "+d+"?"),$("#myModalDelete").modal("toggle"),a.toDeleteItem=c,a.toDeleteList=b,console.log("toDeleteItem="+a.toDeleteItem)},a.deleteSwitch=function(){if(0==a.toDeleteItem)alert("Sorry, nothing to delete");else{for(var b=a.topology.topology_json.link_list.length;b--;)(a.topology.topology_json.link_list[b].id_1==a.toDeleteItem||a.topology.topology_json.link_list[b].id_2==a.toDeleteItem)&&a.topology.topology_json.link_list.splice(b,1);if(""==a.toDeleteList)alert("Sorry, nothing to delete");else{var c="";switch(a.toDeleteList){case"core":c=a.topology.topology_json.core_list;break;case"spine":c=a.topology.topology_json.spine_list;break;case"leaf":c=a.topology.topology_json.leaf_list;break;case"host":c=a.topology.topology_json.host_list}for(var b=c.length;b--;)c[b].id==a.toDeleteItem&&c.splice(b,1)}k.debug("Deleting switch from switch list & its corresponding links from link list"),k.debug(a.topology),doReload(a.topology)}},a.addLinkModal=function(b){a.linkFor=b,$("#myModalLink").modal("toggle")},a.checkLinkExists=function(b,c){if(k.debug("switch1 and switch2"),console.log(b),console.log(c),void 0==b||void 0==c)return $("#alertLinkExists").hide(),!1;b==c?$("#alertLinkSame").show():$("#alertLinkSame").hide();for(var d=0;d<a.topology.topology_json.link_list.length;d++){if(a.topology.topology_json.link_list[d].id_1==b.id&&a.topology.topology_json.link_list[d].id_2==c.id||a.topology.topology_json.link_list[d].id_2==b.id&&a.topology.topology_json.link_list[d].id_1==c.id)return $("#alertLinkExists").show(),!1;$("#alertLinkExists").hide()}return!0},a.addLink=function(b,c){$("#myModalLink").modal("toggle");var d=angular.copy(a.linkStructure);d.id_1=b.id,d.id_2=c.id,d.switch_1=b.name,d.switch_2=c.name,d.link_type=a.linkTypes[4].link_type,console.log(d),a.topology.topology_json.link_list.push(d),doReload(a.topology)},a.removeItemLinkType=function(b){(a.topology.topology_json.link_list[b].switch_1.indexOf("leaf")>-1||a.topology.topology_json.link_list[b].switch_2.indexOf("leaf")>-1)&&(a.topology.topology_json.link_list[b].switch_1.indexOf("spine")>-1||a.topology.topology_json.link_list[b].switch_2.indexOf("spine")>-1)?confirm("You cannot remove a link between a Spine and a Leaf. Click OK to clear the Link and Port details")&&(a.topology.topology_json.link_list[b].link_type="",a.topology.topology_json.link_list[b].port_list_1=[],a.topology.topology_json.link_list[b].port_list_2=[]):a.topology.topology_json.link_list.splice(b,1),doReload(a.topology)},a.toggleDetailsModel=!0,a.toggleDefaultsModel=!1,a.resizeSvgArea=function(){document.getElementById("popEdit").style.right="25%",document.getElementById("popEditLink").style.right="25%",document.getElementById("topology_container").className="col-sm-9"},a.resetSvgArea=function(){document.getElementById("popEdit").style.right="0%",document.getElementById("popEditLink").style.right="0%",document.getElementById("topology_container").className="col-sm-12"},a.toggleDetails=function(){a.toggleDetailsModel?(a.resizeSvgArea(),a.toggleDefaultsModel=!1):a.resetSvgArea()},a.toggleDefault=function(){a.toggleDefaultsModel?(a.resizeSvgArea(),a.toggleDetailsModel=!1):a.resetSvgArea()},a.PopEdit=function(a){PopEdit(a)},a.PopEditLink=function(a){PopEditLink(a)},a.applyDefault=function(b,c,d){k.debug("Initial Values"),k.debug(a.spineStructure),k.debug(a.leafStructure),k.debug(a.spineToLeafLinkType),k.debug(d),angular.isUndefined(b)||(a.spineStructure.type=b,a.topology.defaults.spine_switch=b),angular.isUndefined(c)||(a.leafStructure.type=c,a.topology.defaults.leaf_switch=c),angular.isUndefined(d)||(a.spineToLeafLinkTypeDefault=parseInt(d),a.topology.defaults.spine_leaf_link=a.linkTypes[parseInt(d)].link_type,a.topology.defaults.spine_leaf_link_index=d),k.debug("Changed Values"),k.debug(a.spineStructure),k.debug(a.leafStructure),k.debug(a.spineToLeafLinkType),console.log("----View updated topologyJson with defaults set"),console.log(a.topology),n.create({className:"success",content:"Default settings updated, successfully!."})},a.init=function(){k.debug("Initial Topology Object by creating a copy of the data got from JSON"),k.debug(a.topology),a.selectedId=c.topologyId,a.action=c.mode,a.processRequest()},a.processRequest=function(){"add"==a.action?(a.topology=angular.copy(a.topologyData),k.debug(a.topology),k.debug(a.topologyData),setTopologyData(a.topology)):("edit"==a.action||"view"==a.action)&&(k.debug("Its a Edit or View Request."),a.loadTopologyData(a.selectedId))},a.loadTopologyData=function(b){var c={appendToURL:!0,value:b,noTrailingSlash:!0};g.doAPIRequest(f.appAPI.topology.getById,null,c).then(function(b){k.debug("Data Fetched for Topology Id : "+a.selectedId),k.debug(b),a.topology=angular.copy(b),a.topologyData=angular.copy(b),k.debug(a.topology),setTopologyData(a.topology),k.debug("Topolgy Loaded.")})},a.saveTopology=function(){var b=a.topology;if("add"==a.action)k.debug("Adding new topology to DB."),console.log(b),g.doAPIRequest(f.appAPI.topology.add,b,null).then(function(b){k.debug("Topology Added."),n.create({className:"success",content:"Topology Added Successfully."}),a.goBack("/topology/edit/"+b.id)});else if("edit"==a.action){var c={appendToURL:!0,value:a.selectedId,noTrailingSlash:!0};k.debug("DATA FOR PUT Request."),k.debug(b),g.doAPIRequest(f.appAPI.topology.edit,b,c).then(function(b){k.debug("Topology Saved."),k.debug(b),n.create({className:"success",content:"Topology Updated Successfully."}),a.goBack("/topology/edit/"+b.id)})}},a.submitTopology=function(){k.debug("Submitting topology.");var b=a.topology;if(console.log(b),b.submit=!0,"add"==a.action)g.doAPIRequest(f.appAPI.topology.add,b,null).then(function(b){k.debug("Topology Submitted."),n.create({className:"success",content:"Topology Submitted Successfully."}),a.goBack("/topology")});else if("edit"==a.action){var c={appendToURL:!0,value:a.selectedId,noTrailingSlash:!0};g.doAPIRequest(f.appAPI.topology.edit,b,c).then(function(b){k.debug("Topology Submitted."),n.create({className:"success",content:"Topology Submitted Successfully."}),a.goBack("/topology")})}},a.changeAction=function(b){a.action=b},a.deleteTopology=function(b){a.selectedId=b;var c=j.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/deleteModal.html",controller:"TopologyDeleteModalCtrl",size:"md",backdrop:"static",resolve:{dataToModal:function(){return{id:a.selectedId,callerScope:a}}}});c.result.then(function(b){a.submitData(b)},function(){k.info("Modal dismissed at: "+new Date)})},a.cloneTopology=function(b){a.action="clone",a.selectedId=b,a.openCloneModal()},a.openCloneModal=function(b){k.debug("Executing Clone Model.");var c=j.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/cloneModal.html",controller:"TopologyCloneModalCtrl",size:"sm",resolve:{dataToModal:function(){return{action:a.action,id:a.selectedId}}}});c.result.then(function(b){a.submitData(b)},function(){k.info("Modal dismissed at: "+new Date)})},a.submitData=function(b){if("delete"==b.action){var c={appendToURL:!0,value:a.selectedId,noTrailingSlash:!0};g.doAPIRequest(f.appAPI.topology["delete"],null,c).then(function(b){a.goBack("/topology")})}else if("clone"==b.action){var d=(b.submitData,{appendToURL:!0,value:a.selectedId,noTrailingSlash:!0});g.doAPIRequest(f.appAPI.topology.getById,null,d).then(function(c){k.debug("Data Fetched for Topology Id : "+a.selectedId),k.debug(c);var d=c;d.id="",d.name=b.submitData.NewCloneName,d.submit="false",g.doAPIRequest(f.appAPI.topology.add,d,null).then(function(b){k.debug("Topology Cloned."),a.goBack("/topology/edit/"+b.id)})})}},angular.element("#topology_svg").ready(function(){k.debug(angular.element("#topology_svg")),k.debug("Document Loaded"),a.init()})}]),angular.module("PoapServer").controller("TopologyCloneModalCtrl",["$scope","$modalInstance","appSettings","appServices","dataToModal",function(a,b,c,d,e){a.action=e.action,a.id=e.id,a.submitData={NewCloneName:""},a.ok=function(){b.close({submitData:a.submitData,action:a.action,id:a.id})},a.cancel=function(){b.dismiss("cancel")}}]),angular.module("PoapServer").controller("TopologyDeleteModalCtrl",["$scope","$modalInstance","appSettings","appServices","dataToModal",function(a,b,c,d,e){a.ok=function(){b.close({action:"delete",id:e.id})},a.cancel=function(){b.dismiss("cancel")}}]),angular.module("PoapServer").controller("DiscoveryRuleCtrl",["$scope","$location","$filter","ngTableParams","appSettings","appServices","gettextCatalog","lclStorage","$modal","$log","$timeout","roundProgressService",function(a,b,c,d,e,f,g,h,i,j,k,l){f.setInternalAppUI(a);a.$parent;a.totalItems=64,a.currentPage=4,a.maxSize=5,a.bigTotalItems=175,a.bigCurrentPage=1,a.animationsEnabled=!0,a.discoveryRules=[],a.animationsEnabled=!0,a.tableParams=new d({page:1,count:e.tableSettings.count,sorting:{name:"asc"},filter:{name:a.searchKeyword}},{counts:[],getData:function(b,d){console.log(a.searchKeyword),f.tablePagination(b,c,d,a.discoveryRules,a.searchKeyword)}}),a.$watch("searchKeyword",function(){a.tableParams.reload(),a.tableParams.page(1)}),a.setPage=function(b){a.currentPage=b},a.pageChanged=function(){j.log("Page changed to: "+a.currentPage)},a.checkAll=function(b){a.isChecked=$(b.toElement).is(":checked")},a.toggleAnimation=function(){a.animationsEnabled=!a.animationsEnabled},a.getDiscoveryRule=function(b){f.doAPIRequest(e.appAPI.discoveryRule.list,null,null).then(function(b){a.discoveryRules=b,a.totalDiscoveryRules=a.discoveryRules.length,a.tableParams.reload()})},a.getConfigurationList=function(){f.doAPIRequest(e.appAPI.configuration.list,null,null).then(function(b){a.configurations=b})},a.addRule=function(){a.action="add",a.selectedId=null,a.openRuleModal()},a.viewRule=function(b){a.action="view",a.selectedId=b,a.openRuleModal()},a.editRule=function(b){a.action="edit",a.selectedId=b,a.openRuleModal()},a.deleteRule=function(b,c){a.selectedId=b;var d=i.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/deleteModal.html",controller:"RuleDeleteModalCtrl",size:"md",backdrop:"static",resolve:{dataToModal:function(){return{id:a.selectedId,index:c,callerScope:a}}}});d.result.then(function(b){a.submitData(b)},function(){j.info("Modal dismissed at: "+new Date)}),a.init()},a.openRuleModal=function(b){a.modalInstance=i.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/ruleModal.html",controller:"RuleModalCtrl",size:"lg",backdrop:"static",resolve:{dataToModal:function(){return{action:a.action,id:a.selectedId,configurations:a.configurations,callerScope:a}}}}),a.modalInstance.result.then(function(b){a.submitData(b)},function(){j.info("Modal dismissed at: "+new Date)})},a.submitData=function(b){if("add"==b.action){var c=b.submitData,d={};f.doAPIRequest(e.appAPI.discoveryRule.add,c,null).then(function(b){a.init()})}else if("edit"==b.action){var c=b.submitData,d={appendToURL:!0,value:a.selectedId};f.doAPIRequest(e.appAPI.discoveryRule.edit,c,d).then(function(b){console.log(b),a.init()})}else if("delete"==b.action){var d={appendToURL:!0,value:a.selectedId};f.doAPIRequest(e.appAPI.discoveryRule["delete"],null,d).then(function(b){a.init("delete"),a.modalInstance.dismiss()})}},a.init=function(){a.getConfigurationList(),a.getDiscoveryRule()},a.init()}]),angular.module("PoapServer").controller("RuleModalCtrl",["$scope","$modalInstance","appSettings","appServices","dataToModal",function(a,b,c,d,e){a.appSettings=c,a.action=e.action,a.configurations=e.configurations,a.submitData={name:"",priority:c.defaultData.discoveryRule.priority,config_id:c.defaultData.discoveryRule.buildConfigurationId,match:c.defaultData.discoveryRule.match,subrules:[{rn_condition:c.defaultData.discoveryRule.rnCondition,rn_string:"",rp_condition:c.defaultData.discoveryRule.rpCondition,rp_string:"",lp_condition:c.defaultData.discoveryRule.lpCondition,lp_string:""}],subrules_serial_id:[""]},a.ok=function(){"serial_id"==a.submitData.match&&(a.submitData.subrules=a.submitData.subrules_serial_id,delete a.submitData.subrules_serial_id),b.close({submitData:a.submitData,action:a.action})},a.cancel=function(){b.dismiss("cancel")},a.getData=function(){if("view"==a.action||"edit"==a.action||"external"==a.action){var b={appendToURL:!0,value:e.id};d.doAPIRequest(c.appAPI.discoveryRule.getById,null,b).then(function(b){a.submitData=b,"serial_id"==a.submitData.match&&(a.submitData.subrules_serial_id=a.submitData.subrules)})}},a.init=function(){a.getData()},a.changeAction=function(b){a.action=b},a.addSubRule=function(){a.submitData.subrules.push({rn_condition:c.defaultData.discoveryRule.rnCondition,rn_string:"",rp_condition:c.defaultData.discoveryRule.rpCondition,rp_string:"",lp_condition:c.defaultData.discoveryRule.lpCondition,lp_string:""})},a.addSubRuleSerialID=function(){a.submitData.subrules_serial_id.push("")},a.removeSubRule=function(b){a.submitData.subrules.splice(b,1)},a.removeSubRuleSerialID=function(b){a.submitData.subrules_serial_id.splice(b,1)},a.deleteRule=function(){e.callerScope.deleteRule(e.id,e.index)},a.init()}]),angular.module("PoapServer").controller("RuleDeleteModalCtrl",["$scope","$modalInstance","appSettings","appServices","dataToModal",function(a,b,c,d,e){a.ok=function(){b.close({action:"delete",id:e.id,index:e.index})},a.cancel=function(){b.dismiss("cancel")}}]),angular.module("PoapServer").controller("FabricInstanceCtrl",["$scope","$location","$filter","ngTableParams","appSettings","appServices","gettextCatalog","lclStorage","$modal","$log","$timeout","roundProgressService","ngToast",function(a,b,c,d,e,f,g,h,i,j,k,l,m){f.setInternalAppUI(a);a.$parent;a.totalItems=64,a.currentPage=4,a.maxSize=5,a.bigTotalItems=175,a.bigCurrentPage=1,a.animationsEnabled=!0,a.fabricInstances=[],a.animationsEnabled=!0,a.tableParams=new d({page:1,count:e.tableSettings.count,sorting:{name:"asc"},filter:{name:a.searchKeyword}},{counts:[],getData:function(b,d){f.tablePagination(b,c,d,a.fabricInstances,a.searchKeyword)}}),a.$watch("searchKeyword",function(){a.tableParams.reload(),a.tableParams.page(1)}),a.checkAll=function(b){a.isChecked=$(b.toElement).is(":checked")},a.getFabricInstanceList=function(b){f.doAPIRequest(e.appAPI.fabricInstance.list,null,null).then(function(b){a.fabricInstances=b,a.totalFabricInstances=a.fabricInstances.length,a.tableParams.reload()})},a.deleteFabricInstance=function(b,c){a.selectedId=b;var d=i.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/deleteModal.html",controller:"FabricInstanceDeleteModalCtrl",size:"md",resolve:{dataToModal:function(){return{id:a.selectedId,index:c,callerScope:a}}}});d.result.then(function(b){a.submitData(b)},function(){j.info("Modal dismissed at: "+new Date)}),a.init()},a.cloneFabricInstance=function(b){a.action="clone",a.selectedId=b,a.openCloneModal()},a.openCloneModal=function(b){console.log("Inside Open Clone");var c=i.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/cloneModal.html",controller:"FabricInstanceCloneModalCtrl",size:"sm",resolve:{dataToModal:function(){return{action:a.action,id:a.selectedId}}}});c.result.then(function(b){a.submitData(b)},function(){j.info("Modal dismissed at: "+new Date)})},a.submitData=function(b){if("delete"==b.action){var c={appendToURL:!0,value:a.selectedId,noTrailingSlash:!0};f.doAPIRequest(e.appAPI.fabricInstance["delete"],null,c).then(function(b){m.create({className:"success",content:"Fabric Instance Deleted Successfully."}),a.init("delete")})}else if("clone"==b.action){var d=(b.submitData,{appendToURL:!0,value:a.selectedId,noTrailingSlash:!0});f.doAPIRequest(e.appAPI.fabricInstance.getById,null,d).then(function(c){j.debug("Data Fetched for FabricInstance Id : "+a.selectedId),j.debug(c);var d=angular.copy(c);j.debug("DATA::"),j.debug(c),d.id="",d.name=b.submitData.NewCloneName,console.log("New FI"),console.log(d),d.submit="false",d.topology_id=d.topology.topology_id,f.doAPIRequest(e.appAPI.fabricInstance.add,d,null).then(function(b){m.create({className:"success",content:"FabricInstance Cloned Successfully."}),a.init("cloned")})})}},a.init=function(){a.getFabricInstanceList()},a.init()}]),angular.module("PoapServer").controller("FabricInstanceCloneModalCtrl",["$scope","$modalInstance","appSettings","appServices","dataToModal",function(a,b,c,d,e){a.action=e.action,a.id=e.id,a.submitData={NewCloneName:""},a.ok=function(){b.close({submitData:a.submitData,action:a.action,id:a.id})},a.cancel=function(){b.dismiss("cancel")},a.init=function(){},a.init()}]),angular.module("PoapServer").controller("FabricInstanceDeleteModalCtrl",["$scope","$modalInstance","appSettings","appServices","dataToModal",function(a,b,c,d,e){a.ok=function(){b.close({action:"delete",id:e.id,index:e.index})},a.cancel=function(){b.dismiss("cancel")}}]),angular.module("PoapServer").controller("AddFabricInstanceCtrl",["$scope","$routeParams","$http","$location","appSettings","appServices","gettextCatalog","lclStorage","$modal","$log","$timeout","roundProgressService","ngToast",function(a,b,c,d,e,f,g,h,i,j,k,l,m){f.setInternalAppUI(a);a.$parent;a.images=null,a.choices=[{id:1,value:"YES"},{id:0,value:"NO"}],a.topologyData="",a.animationsEnabled=!0,a.fabricData={name:"",submit:"false",instance:e.defaultData.fabricInstance.replica,topology_id:e.defaultData.fabricInstance.topologyId,locked:e.defaultData.fabricInstance.locked,validate:e.defaultData.fabricInstance.validate,config_json:[],system_id:[],image_details:{leaf_switch:"",spine_switch:""}},a.getImages=function(){f.doAPIRequest(e.appAPI.images.list,null,null).then(function(b){a.images=b})},a.setConfigModal=function(b){var c=i.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/setConfigurationModal.html",controller:"SetConfigModalCtrl",size:b,backdrop:"static",resolve:{dataToModal:function(){return{configurations:a.configurations,configDetails:a.fabricData.config_json,action:a.action}}}});c.result.then(function(b){a.fabricData.config_json=b.submitData,j.debug("Modal Closed with Apply."),j.debug(b.submitData),j.debug(a.fabricData)},function(){j.info("Modal dismissed at: "+new Date)})},a.getSwitchNames=function(){var b=[],b=(a.topologyData,[]);return a.topologyData.topology_json.core_list.map(function(a){b.push(a.name)}),a.topologyData.topology_json.spine_list.map(function(a){b.push(a.name)}),a.topologyData.topology_json.leaf_list.map(function(a){b.push(a.name)}),b},a.setSerialIDModal=function(b){var c=a.getSwitchNames(),d=i.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/setSerialIDModal.html",controller:"SetSerialIDModalCtrl",size:b,backdrop:"static",resolve:{dataToModal:function(){return{switchNames:c,fabricName:a.fabricData.name,system_id:a.fabricData.system_id,replicas:a.fabricData.instance,action:a.action}}}});d.result.then(function(b){a.fabricData.system_id=b.submitData},function(){j.info("Modal dismissed at: "+new Date)})},a.getTopologyData=function(b){a.submitData.config_json=[],a.topologyData="";var c={appendToURL:!0,value:b,noTrailingSlash:!0};f.doAPIRequest(e.appAPI.topology.getById,null,c).then(function(c){j.debug("Data Fetched for Topology Id : "+b),j.debug(c),a.topology=angular.copy(c),j.debug(a.topology);var d=[];j.debug(a.topology.topology_json.spine_list),a.topology.topology_json.spine_list.map(function(a){d.push(a.name)}),j.debug(a.topology.topology_json.leaf_list),a.topology.topology_json.leaf_list.map(function(a){d.push(a.name)}),j.debug(d),angular.forEach(d,function(b){a.fabricData.config_json.push({name:b,configuration_id:e.defaultData.fabricInstance.buildConfigurationId})}),j.debug(a.submitData),a.topologyData=c,j.debug("Topolgy Loaded.")})},a.addFabricInstanceModal=function(b){var c=i.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/addFabricInstanceModal.html",controller:"AddFabricInstanceModalCtrl",size:b});c.result.then(function(b){a.selected=b},function(){j.info("Modal dismissed at: "+new Date)})},a.toggleAnimation=function(){a.animationsEnabled=!a.animationsEnabled},a.goBack=function(a){d.path(a)},a.getTopologyList=function(){f.doAPIRequest(e.appAPI.topology.list,null,null).then(function(b){a.topologies=angular.copy(b)})},a.getConfigurationList=function(){f.doAPIRequest(e.appAPI.configuration.list,null,null).then(function(b){a.configurations=angular.copy(b)})},a.changeAction=function(b){a.action=b},a.deleteFabricInstance=function(b){a.selectedId=b;var c=i.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/deleteModal.html",controller:"FabricInstanceDeleteModalCtrl",size:"md",backdrop:"static",resolve:{dataToModal:function(){return{id:a.selectedId,callerScope:a}}}});c.result.then(function(b){a.submitData(b)},function(){j.info("Modal dismissed at: "+new Date)})},a.cloneFabricInstance=function(b){j.debug("Cloning Fabric Instance ID : "+b),a.action="clone",a.selectedId=b,a.openCloneModal()},a.openCloneModal=function(b){j.debug("Executing Clone Modal.");var c=i.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/cloneModal.html",controller:"FabricInstanceCloneModalCtrl",size:"sm",backdrop:"static",resolve:{dataToModal:function(){return{action:a.action,id:a.selectedId}}}});c.result.then(function(b){a.submitData(b)},function(){j.info("Modal dismissed at: "+new Date)})},a.submitData=function(b){if("delete"==b.action){var c={appendToURL:!0,value:a.selectedId,noTrailingSlash:!0};f.doAPIRequest(e.appAPI.fabricInstance["delete"],null,c).then(function(b){m.create({className:"success",content:"Fabric Instance Deleted Successfully."}),a.goBack("/fabricInstance")})}else if("clone"==b.action){var d=(b.submitData,{appendToURL:!0,value:a.selectedId,noTrailingSlash:!0});j.debug("Request Header"),j.debug(d),f.doAPIRequest(e.appAPI.fabricInstance.getById,null,d).then(function(c){j.debug("Data Fetched for Fabric Instance Id : "+a.selectedId),j.debug(c);var d=angular.copy(c);d.id="",d.name=b.submitData.NewCloneName,d.submit="false",d.topology_id=d.topology.topology_id,f.doAPIRequest(e.appAPI.fabricInstance.add,d,null).then(function(b){j.debug("Fabric Instance Cloned."),j.debug(b),m.create({className:"success",content:"Fabric Instance Cloned Successfully."}),a.goBack("/fabricInstance/edit/"+b.id)})})}},a.submitFabricInstance=function(){j.debug("Submitting Fabric Instance.");var b=a.fabricData;if(console.log(b),b.submit=!0,"add"==a.action)f.doAPIRequest(e.appAPI.fabricInstance.add,b,null).then(function(b){
j.debug("Fabric Instance Submitted."),m.create({className:"success",content:"Fabric Instance Submitted Successfully."}),a.goBack("/fabricInstance")});else if("edit"==a.action){var c={appendToURL:!0,value:a.selectedId,noTrailingSlash:!0};f.doAPIRequest(e.appAPI.fabricInstance.edit,b,c).then(function(b){j.debug("Fabric Instance Submitted."),m.create({className:"success",content:"Fabric Instance Submitted Successfully."}),a.goBack("/fabricInstance")})}},a.saveFabricInstance=function(){var b=a.fabricData;if("add"==a.action)j.debug("Adding new Fabric Instance to DB."),console.log(b),f.doAPIRequest(e.appAPI.fabricInstance.add,b,null).then(function(b){j.debug("Fabric Instance Added."),m.create({className:"success",content:"Fabric Instance Created Successfully."}),a.goBack("/fabricInstance/edit/"+b.id)});else if("edit"==a.action){var c={appendToURL:!0,value:a.selectedId,noTrailingSlash:!0};j.debug("DATA FOR PUT Request."),j.debug(b),f.doAPIRequest(e.appAPI.fabricInstance.edit,b,c).then(function(b){j.debug("Fabric Instance Updated."),j.debug(b),m.create({className:"success",content:"Fabric Instance Updated Successfully."}),a.goBack("/fabricInstance/edit/"+b.id)})}},a.loadFabricInstance=function(b){var c={appendToURL:!0,value:b,noTrailingSlash:!0};f.doAPIRequest(e.appAPI.fabricInstance.getById,null,c).then(function(b){j.debug("Data Fetched for Fabric Instance Id : "+a.selectedId),j.debug(b),a.fabricData.id=angular.copy(b.id),a.fabricData.name=angular.copy(b.name),a.fabricData.submit=angular.copy(b.submit),a.fabricData.instance=angular.copy(b.instance),a.fabricData.topology_id=angular.copy(b.topology.topology_id),a.fabricData.locked=angular.copy(b.locked),a.fabricData.validate=angular.copy(b.validate),a.fabricData.config_json=angular.copy(b.config_json),a.fabricData.system_id=angular.copy(b.system_id),a.topologyData=angular.copy(b.topology),"undefined"!=typeof b.image_details.leaf_switch&&(a.fabricData.image_details.leaf_switch=b.image_details.leaf_switch,a.fabricData.image_details.spine_switch=b.image_details.spine_switch),j.debug("Collected Fabric Data After GET"),j.debug(a.fabricData)})},a.processRequest=function(){"add"==a.action||("edit"==a.action||"view"==a.action)&&(j.debug("Its a Edit or View Request."),j.debug("For ID : "+a.selectedId),a.loadFabricInstance(a.selectedId))},a.init=function(){a.selectedId=b.fabricInstanceId,a.action=b.mode,a.getConfigurationList(),a.getTopologyList(),a.processRequest(),a.getImages()},angular.element("#topology_svg").ready(function(){j.debug(angular.element("#topology_svg")),j.debug("Document Loaded"),a.init()})}]),angular.module("PoapServer").controller("AddFabricInstanceModalCtrl",["$scope","$modalInstance",function(a,b){a.ok=function(){b.close()},a.cancel=function(){b.dismiss("cancel")}}]),angular.module("PoapServer").controller("SetConfigModalCtrl",["$scope","$modalInstance","$log","appSettings","appServices","dataToModal",function(a,b,c,d,e,f){a.appSettings=d,a.configurations=f.configurations,a.action=f.action,a.submitData=[{switch_name:"",configuration_id:d.defaultData.topology.buildConfigurationId}],a.ok=function(){c.debug("Closing Modal.."),c.debug(a.submitData),b.close({submitData:a.submitData,action:a.action})},a.cancel=function(){b.dismiss("cancel")},a.init=function(){a.submitData=angular.copy(f.configDetails)},a.init()}]),angular.module("PoapServer").controller("SetSerialIDModalCtrl",["$scope","$modalInstance","$log","appSettings","appServices","dataToModal",function(a,b,c,d,e,f){var g={name:"",system_id:""};a.serialIDs=f.system_id,a.fabricName=f.fabricName,a.switchNames=[],a.replicas=f.replicas,a.action=f.action,a.setSwitchNames=function(){angular.forEach(f.switchNames,function(b,c){for(var d=1;d<=a.replicas;d++){var e=a.fabricName+"_"+d+"_"+b;a.switchNames.push(e)}})},a.deleteSerialID=function(b){a.serialIDs.splice(b,1)},a.addAnotherSwitchID=function(){a.serialIDs.push(angular.copy(g))},a.ok=function(){b.close({submitData:a.serialIDs})},a.cancel=function(){b.dismiss("cancel")},a.setSwitchNames()}]),angular.module("PoapServer").controller("FabricInstanceCloneModalCtrl",["$scope","$modalInstance","appSettings","appServices","dataToModal",function(a,b,c,d,e){a.action=e.action,a.id=e.id,a.submitData={NewTopologyName:""},a.ok=function(){b.close({submitData:a.submitData,action:a.action,id:a.id})},a.cancel=function(){b.dismiss("cancel")}}]),angular.module("PoapServer").controller("FabricInstanceDeleteModalCtrl",["$scope","$modalInstance","appSettings","appServices","dataToModal",function(a,b,c,d,e){a.ok=function(){b.close({action:"delete",id:e.id})},a.cancel=function(){b.dismiss("cancel")}}]),angular.module("PoapServer").controller("DeployedFabricCtrl",["$scope","$location","$filter","ngTableParams","appSettings","appServices","gettextCatalog","lclStorage","$modal","$log","$timeout","roundProgressService",function(a,b,c,d,e,f,g,h,i,j,k,l){f.setInternalAppUI(a);a.$parent;a.deployedFabrics=[],a.tableParams=new d({page:1,count:e.tableSettings.count,sorting:{name:"asc"}},{counts:[],getData:function(b,d){f.tablePagination(b,c,d,a.deployedFabrics,a.searchKeyword)}}),a.selectedId=null,a.getDeployedFabrics=function(){f.doAPIRequest(e.appAPI.deployedFabrics.list,null,null).then(function(b){a.deployedFabrics=b,a.tableParams.reload()})},a.init=function(b){a.getDeployedFabrics()},a.$watch("searchKeyword",function(){a.tableParams.reload(),a.tableParams.page(1)}),a.init()}]),angular.module("PoapServer").controller("FabricReplicaCtrl",["$scope","$location","$routeParams","$filter","ngTableParams","appSettings","appServices","gettextCatalog","lclStorage","$modal","$log","$timeout","roundProgressService",function(a,b,c,d,e,f,g,h,i,j,k,l,m){a.appSettings=f,g.setInternalAppUI(a);a.$parent;a.fabricID=c.fabricID,a.replicaNumber=c.replicaNumber,a.replicaDetailsStats=[],a.tableParams=new e({page:1,count:f.tableSettings.count,sorting:{switch_name:"asc"}},{counts:[],getData:function(b,c){g.tablePagination(b,d,c,a.replicaDetailsStats,a.searchKeyword)}}),a.openConfigModal=function(b){a.modalInstance=j.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/fabricConfigView.html",controller:"ViewFabricConfigModalCtrl",size:"lg",backdrop:"static",resolve:{dataToModal:function(){return{statId:b}}}}),a.modalInstance.result.then(function(a){k.info("Modal dismissed at: "+new Date)},function(){k.info("Modal dismissed at: "+new Date)})},a.openLogModal=function(b){a.modalInstance=j.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/logs.html",controller:"ViewFabricLogModalCtrl",size:"lg",backdrop:"static",resolve:{dataToModal:function(){return{statId:b}}}}),a.modalInstance.result.then(function(a){k.info("Modal dismissed at: "+new Date)},function(){k.info("Modal dismissed at: "+new Date)})},a.openRuleModal=function(b){a.modalInstance=j.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/ruleModal.html",controller:"RuleModalCtrl",size:"lg",backdrop:"static",resolve:{dataToModal:function(){return{action:"external",id:b,configurations:a.configurations,callerScope:a}}}}),a.modalInstance.result.then(function(a){},function(){k.info("Modal dismissed at: "+new Date)})},a.getReplicaDetails=function(){var b=a.fabricID+"/"+a.replicaNumber,c={appendToURL:!0,value:b,noTrailingSlash:!0};g.doAPIRequest(f.appAPI.deployedFabrics.replicaDetails,null,c).then(function(b){a.replicaDetails=b,a.replicaDetailsStats=b.stats,a.tableParams.reload()})},a.getConfigurationList=function(){g.doAPIRequest(f.appAPI.configuration.list,null,null).then(function(b){a.configurations=b})},a.init=function(b){a.getConfigurationList(),a.getReplicaDetails()},a.init()}]),angular.module("PoapServer").controller("ViewFabricConfigModalCtrl",["$scope","$modalInstance","FileReader","appSettings","appServices","dataToModal",function(a,b,c,d,e,f){a.getConfigDetails=function(b){var c={appendToURL:!0,value:b,noTrailingSlash:!0};e.doAPIRequest(d.appAPI.deployedFabrics.getConfig,null,c).then(function(b){a.configDetails=b})},a.close=function(){b.dismiss("cancel")},a.getConfigDetails(f.statId)}]),angular.module("PoapServer").controller("ViewFabricLogModalCtrl",["$scope","$modalInstance","FileReader","appSettings","appServices","dataToModal",function(a,b,c,d,e,f){a.close=function(){b.dismiss("cancel")},a.getLogDetails=function(b){var c={appendToURL:!0,value:b,noTrailingSlash:!0};e.doAPIRequest(d.appAPI.deployedFabrics.getLog,null,c).then(function(b){a.logDetails=b})},a.getLogDetails(f.statId)}]),angular.module("PoapServer").controller("DeployedSwitchesCtrl",["$scope","$location","$routeParams","$filter","ngTableParams","appSettings","appServices","gettextCatalog","lclStorage","$modal","$log","$timeout","roundProgressService",function(a,b,c,d,e,f,g,h,i,j,k,l,m){a.appSettings=f,g.setInternalAppUI(a);a.$parent;a.switchDetailsStats=[],a.tableParams=new e({page:1,count:f.tableSettings.count,sorting:{switch_name:"asc"}},{counts:[],getData:function(b,c){g.tablePagination(b,d,c,a.switchDetailsStats,a.searchKeyword)}}),a.openConfigModal=function(b){a.modalInstance=j.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/fabricConfigView.html",controller:"ViewFabricConfigModalCtrl",size:"lg",backdrop:"static",resolve:{dataToModal:function(){return{statId:b}}}}),a.modalInstance.result.then(function(a){k.info("Modal dismissed at: "+new Date)},function(){k.info("Modal dismissed at: "+new Date)})},a.openLogModal=function(b){a.modalInstance=j.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/logs.html",controller:"ViewFabricLogModalCtrl",size:"lg",backdrop:"static",resolve:{dataToModal:function(){return{statId:b}}}}),a.modalInstance.result.then(function(a){k.info("Modal dismissed at: "+new Date)},function(){k.info("Modal dismissed at: "+new Date)})},a.openRuleModal=function(b){a.modalInstance=j.open({animation:a.animationsEnabled,templateUrl:"pages/template/modal/ruleModal.html",controller:"RuleModalCtrl",size:"lg",backdrop:"static",resolve:{dataToModal:function(){return{action:"external",id:b,configurations:a.configurations,callerScope:a}}}}),a.modalInstance.result.then(function(a){},function(){k.info("Modal dismissed at: "+new Date)})},a.getSwitchDetails=function(){g.doAPIRequest(f.appAPI.deployedSwitches.list,null,!1).then(function(b){a.switchDetailsStats=b,a.tableParams.reload()})},a.getConfigurationList=function(){g.doAPIRequest(f.appAPI.configuration.list,null,null).then(function(b){a.configurations=b})},a.init=function(b){a.getConfigurationList(),a.getSwitchDetails()},a.init()}]),angular.module("PoapServer").controller("errorModalCtrl",["$scope","$modalInstance","$rootScope","appServices",function(a,b,c,d){a.appServices=d,a.ok=function(){b.dismiss("cancel")}}]),app.directive("onReadFile",["$parse",function(a){return{restrict:"A",scope:!1,link:function(b,c,d){var e=a(d.onReadFile);c.on("change",function(a){var c=new FileReader;c.onload=function(a){b.$apply(function(){e(b,{$fileContent:a.target.result})})},c.readAsText((a.srcElement||a.target).files[0])})}}}]),app.filter("link",function(){return function(a){return a?angular.lowercase(a.replace(/ /g,"")):""}}),app.filter("nospace",function(){return function(a){return a?a.replace(/ /g,""):""}}),app.filter("hidemaildomain",function(){return function(a){return a?a.replace(/@.*/g,""):""}}),app.filter("NA",function(){return function(a){return null==a||""==a?"NA":a}}),app.filter("empty",function(){return function(a){return null==a||"null"==a||""==a?"":a}}),app.filter("totalVaue",function(){return function(a,b){if("undefined"==typeof a&&"undefined"==typeof b)return 0;if("undefined"!=typeof a){for(var c=0,d=0;d<a.length;d++)c+=a[d][b];var e="";c>999999?(c/=1e6,e="M"):c>999&&(c/=1e3,e="K");var f=c.toFixed(2)+e;return f}}}),app.filter("kiloMil",function(){return function(a){if("undefined"==typeof a&&"undefined"==typeof key)return 0;var b="";a>999999?(a/=1e6,b="M"):a>999&&(a/=1e3,b="K");var c=a.toFixed(1);return parseFloat(c)+b}}),app.filter("count",function(){return function(a){return angular.isObject(a)?Object.keys(a).length:null!=a&&"null"!=a&&""!=a&&void 0!=a?a.length:0}}),app.filter("age",["$filter",function(a){return function(b){if(void 0!=b){var c=a("date")(b,"mm/dd/yyyy"),d=c.split("/"),e=d[2];return(new Date).getFullYear()-e}}}]),app.filter("filter_link",function(){return function(a,b){for(var c=[],d=0;d<a.length;d++)for(j=0;j<a[d].link_combo.length;j++)b[0].indexOf(a[d].link_combo[j][0])>-1&&b[1].indexOf(a[d].link_combo[j][1])>-1&&c.push(a[d]);return c}});